!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("matchit")):"function"==typeof define&&define.amd?define(["matchit"],n):(t=t||self).operator=n(t.matchit)}(this,function(t){var n=new Map;function e(t){return t.replace(window.location.origin,"")}function r(n,e){var r="",a="",o=n.split(/#|\?/),i=o[0],c=o.slice(1);i=(i=i.replace(/\/$/g,""))||"/";for(var u=0;u<c.length;u++){var f=n.split(c[u])[0];"?"===f[f.length-1]&&(a=c[u]),"#"===f[f.length-1]&&(r=c[u])}var l=t.match(i,e.map(function(t){return t.matcher})),h=e.filter(function(t){return t.path===l[0].old})[0];return l[0]?Object.assign({},h,{params:t.exec(i,l),hash:r,search:a,pathname:i,location:n}):null}return function(a,o){void 0===o&&(o=["*"]);var i,c=document.querySelector(a),u=[],f={};o=o.concat(o.indexOf("*")<0?"*":[]).reduce(function(t,n){return"function"==typeof n?(u.push(n),t):t.concat(n)},[]).map(function(n){return n.path?Object.assign({},n,{matcher:t.parse(n.path)}):{path:n,matcher:t.parse(n)}});var l=r(e(window.location.href),o),h=Object.assign({previousDocument:null},l);function s(t){return f[t]?f[t].map(function(t){return t(h)}):[]}function p(t,n,e,r){h.previousDocument=t.cloneNode(!0),Promise.all(u.concat(e.handler||[]).map(function(t){return t(h)})).then(function(){requestAnimationFrame(function(){c.innerHTML=n,s("after"),e.hash&&s("hash")})})}function d(t,e,r){if(!e)return window.location.href=t;fetch(t,{credentials:"include"}).then(function(t){return t.text()}).then(function(o){var i=(new window.DOMParser).parseFromString(o,"text/html"),c=[i,i.querySelector(a).innerHTML];n.set(t,c),r&&r(c[0],c[1],e)})}function m(t,e,r){i=function(){var r=n.get(t);r&&!1!==e.cache?p(r[0],r[1],e):d(t,e,p)},Object.assign(h,e),Promise.all(s("before")).then(i)}function v(t){var n=e(t);return[n,r(n,o)]}return document.body.addEventListener("click",function(t){if(!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.defaultPrevented)){for(var n=t.target;n&&(!n.href||"A"!==n.nodeName);)n=n.parentNode;if(!n)return t;var e=v(n.href),r=e[0],a=e[1];return a.ignore?t:h.pathname===a.pathname&&a.hash?(t.preventDefault(),Object.assign(h,a),s("hash"),t):window.location.origin!==n.origin||n.hasAttribute("download")||"_blank"===n.target||/^(?:mailto|tel):/.test(n.href)||n.classList.contains("no-ajax")?t:(t.preventDefault(),h.location!==r&&m(r,a),s("navigate"),!1)}}),window.addEventListener("popstate",function(t){if(t.target.location.pathname!==h.pathname)return m.apply(void 0,v(t.target.location.href).concat([!0])),!1}),{get state(){return h},go:function(t){i=null,m.apply(void 0,v(t).concat([!1]))},load:function(t,n){return d.apply(void 0,v(t).concat([n]))},on:function(t,n){return f[t]=f[t]?f[t].concat(n):[n],function(){return f[t].slice(f[t].indexOf(n),1)}}}}});
//# sourceMappingURL=operator.umd.js.map
